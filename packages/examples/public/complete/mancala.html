<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script lang="text/js" defer>
      window.__unocss = {
        theme: { colors: { nytimes: { green: '#6aaa64', yellow: '#c9b458' } } }
      }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@unocss/runtime"></script>

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@unocss/reset/tailwind.min.css"
    />
  </head>
  <body>
    <div id="app"></div>

    <script type="module" defer>
      import {
        MotionPlugin,
        useMotion,
      } from 'https://cdn.jsdelivr.net/npm/@vueuse/motion@2.2.6/+esm';

      const { ref, computed, createApp } = Vue;

      const app = createApp({
        setup() {
          const pits = ref(Array(14).fill(4));
          pits.value[6] = 0; // Store for player 1
          pits.value[13] = 0; // Store for player 2
          
          const currentPlayer = ref(1);
          const isPlayer1Turn = computed(() => currentPlayer.value === 1);

          const moveStones = (index) => {
            let stones = pits.value[index];
            pits.value[index] = 0;
            let i = index;
            while (stones > 0) {
              i = (i + 1) % 14;
              if ((currentPlayer.value === 1 && i === 13) || (currentPlayer.value === 2 && i === 6)) continue;
              pits.value[i]++;
              stones--;
            }

            if ((currentPlayer.value === 1 && i === 6) || (currentPlayer.value === 2 && i === 13)) {
              // Player gets another turn
              return;
            }

            currentPlayer.value = currentPlayer.value === 1 ? 2 : 1;
          };

          return { pits, isPlayer1Turn, moveStones };
        },
        template: `
        <div class="flex flex-col items-center justify-center min-h-screen bg-gray-100">
          <div class="mb-4 text-2xl font-bold">Mancala</div>
          <div class="flex items-center space-x-4">
            <div v-for="(pit, index) in pits" :key="index" class="flex flex-col items-center">
              <div 
                v-if="index !== 6 && index !== 13" 
                class="flex items-center justify-center w-16 h-16 bg-gray-200 rounded-full cursor-pointer"
                @click="moveStones(index)">
                {{ pit }}
              </div>
              <div 
                v-else 
                class="flex items-center justify-center w-20 h-20 rounded-lg bg-nytimes-yellow">
                {{ pit }}
              </div>
            </div>
          </div>
          <div class="mt-4 text-lg">
            Current Player: {{ isPlayer1Turn ? 'Player 1' : 'Player 2' }}
          </div>
        </div>
      `,
      });

      app.use(MotionPlugin);
      app.mount('#app');
    </script>
  </body>
</html>
