<!DOCTYPE html>
<html lang="en">
  <head>
    <title>V1</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />

    <!-- Vue -->
    <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.js"></script>

    <!-- RxJS -->
    <script src="https://cdn.jsdelivr.net/npm/rxjs@^7/dist/bundles/rxjs.umd.min.js"></script>

    <!-- Vue Use -->
    <script src="https://cdn.jsdelivr.net/npm/@vueuse/shared"></script>
    <script src="https://cdn.jsdelivr.net/npm/@vueuse/core"></script>
    <script src="https://cdn.jsdelivr.net/npm/@vueuse/rxjs"></script>

    <!-- Prime Vue -->
    <script src="https://cdn.jsdelivr.net/npm/primevue/umd/primevue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@primevue/themes/umd/aura.min.js"></script>

    <!-- Icons -->
    <script src="https://cdn.jsdelivr.net/npm/heroicons-css@0.1.1/heroicons.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/heroicons-css@0.1.1/heroicons.min.css"
      rel="stylesheet"
    />

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script lang="text/js">
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              kossabos: { green: '#6aaa64', yellow: '#c9b458' }
            }
          }
        }
      }
    </script>
  </head>
  <body class="text-black bg-white">
    <main id="app"></main>

    <script type="module">
      import * as VueUseMotion from 'https://cdn.jsdelivr.net/npm/@vueuse/motion@2.2.6/+esm';
      const { MotionPlugin } = VueUseMotion;
      window.VueUseMotion = VueUseMotion;


      import { on } from '/src/core/events.ts';
      import { createChildMessageBus } from '/src/core/message-bus.ts';
      import { getQueryParam, loadScript } from '/util.js';

      const { BehaviorSubject } = rxjs;
      const events = new BehaviorSubject();
      const messageBus = createChildMessageBus((e) => events.next(e));

      window.Kossabos = { on: on(events), emit: messageBus.postMessage };

      const styleConfig = {
        theme: {
          preset: PrimeVue.definePreset(PrimeVue.Themes.Aura, {
            semantic: {
              primary: {
                50: '{zinc.50}',
                100: '{zinc.100}',
                200: '{zinc.200}',
                300: '{zinc.300}',
                400: '{zinc.400}',
                500: '{zinc.500}',
                600: '{zinc.600}',
                700: '{zinc.700}',
                800: '{zinc.800}',
                900: '{zinc.900}',
                950: '{zinc.950}',
              },
              colorScheme: {
                light: {
                  primary: {
                    color: '{zinc.950}',
                    inverseColor: '#ffffff',
                    hoverColor: '{zinc.900}',
                    activeColor: '{zinc.800}',
                  },
                  highlight: {
                    background: '{zinc.950}',
                    focusBackground: '{zinc.700}',
                    color: '#ffffff',
                    focusColor: '#ffffff',
                  },
                },
                dark: {
                  primary: {
                    color: '{zinc.50}',
                    inverseColor: '{zinc.950}',
                    hoverColor: '{zinc.100}',
                    activeColor: '{zinc.200}',
                  },
                  highlight: {
                    background: 'rgba(250, 250, 250, .16)',
                    focusBackground: 'rgba(250, 250, 250, .24)',
                    color: 'rgba(255,255,255,.87)',
                    focusColor: 'rgba(255,255,255,.87)',
                  },
                },
              },
            },
          }),
          options: {
            darkModeSelector: 'system',
            cssLayer: false,
          },
        },
      };

      const projectId = getQueryParam('projectId');
      loadScript(`/src/examples/${projectId}/index.js`, (app) => {
        app.use(PrimeVue.Config, styleConfig);

        app.component('button', PrimeVue.Button);
        app.use(MotionPlugin);
        app.mount('#app');

        messageBus.postMessage('loaded');
      });
    </script>
  </body>
</html>
