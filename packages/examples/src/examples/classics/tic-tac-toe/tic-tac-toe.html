<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NY Times Tic Tac Toe</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <script lang="text/js" defer>
    window.__unocss = {
      theme: {
        colors: {
          kossabos: {
            green: '#6aaa64',
            yellow: '#c9b458'
          }
        }
      }
    }
  </script>
  <script src="https://cdn.jsdelivr.net/npm/@unocss/runtime"></script>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@unocss/reset/tailwind.min.css">
</head>
<body>
  <div id="app"></div>

  <script type="module" defer>
    import { useMotion, MotionPlugin } from 'https://cdn.jsdelivr.net/npm/@vueuse/motion@2.2.6/+esm';
    const { ref, computed, createApp } = Vue

    const app = createApp({
      setup() {
        const board = ref(Array(9).fill(null))
        const currentPlayer = ref('X')
        const winner = ref(null)
        const gameOver = ref(false)

        const winningCombos = [
          [0, 1, 2], [3, 4, 5], [6, 7, 8], // Rows
          [0, 3, 6], [1, 4, 7], [2, 5, 8], // Columns
          [0, 4, 8], [2, 4, 6] // Diagonals
        ]

        const makeMove = (index) => {
          if (!board.value[index] && !winner.value) {
            board.value[index] = currentPlayer.value
            checkWinner()
            currentPlayer.value = currentPlayer.value === 'X' ? 'O' : 'X'
          }
        }

        const checkWinner = () => {
          for (let combo of winningCombos) {
            if (
              board.value[combo[0]] &&
              board.value[combo[0]] === board.value[combo[1]] &&
              board.value[combo[0]] === board.value[combo[2]]
            ) {
              winner.value = board.value[combo[0]]
              gameOver.value = true
              return
            }
          }
          if (board.value.every(cell => cell !== null)) {
            gameOver.value = true
          }
        }

        const resetGame = () => {
          board.value = Array(9).fill(null)
          currentPlayer.value = 'X'
          winner.value = null
          gameOver.value = false
        }

        const cellMotion = useMotion({
          initial: { scale: 0.5, opacity: 0 },
          enter: { scale: 1, opacity: 1 },
          transition: { type: 'spring', stiffness: 250, damping: 25 }
        })

        const resultMotion = useMotion({
          initial: { y: 20, opacity: 0 },
          enter: { y: 0, opacity: 1 },
          transition: { type: 'spring', stiffness: 300, damping: 30 }
        })

        return {
          board,
          currentPlayer,
          winner,
          gameOver,
          makeMove,
          resetGame,
          cellMotion,
          resultMotion
        }
      },
      template: `
        <div class="flex items-center justify-center min-h-screen bg-gray-100">
          <div class="w-full max-w-md p-8 bg-white shadow-lg rounded-xl">
            <h1 class="mb-6 text-3xl font-bold text-center text-gray-800">NY Times Tic Tac Toe</h1>
            <div class="grid grid-cols-3 gap-2 mb-6">
              <button
                v-for="(cell, index) in board"
                :key="index"
                @click="makeMove(index)"
                class="flex items-center justify-center w-20 h-20 text-4xl font-bold transition-colors duration-200 rounded"
                :class="[
                  cell === 'X' ? 'bg-kossabos-green text-white' :
                  cell === 'O' ? 'bg-kossabos-yellow text-white' :
                  'bg-gray-200 hover:bg-gray-300'
                ]"
                v-motion="cellMotion"
              >
                {{ cell }}
              </button>
            </div>
            <div v-if="gameOver" v-motion="resultMotion" class="mb-6 text-center">
              <p v-if="winner" class="text-2xl font-bold text-gray-800">
                Player {{ winner }} wins!
              </p>
              <p v-else class="text-2xl font-bold text-gray-800">
                It's a draw!
              </p>
            </div>
            <div v-else class="mb-6 text-center">
              <p class="text-xl text-gray-700">
                Current player: <span class="font-bold">{{ currentPlayer }}</span>
              </p>
            </div>
            <button
              @click="resetGame"
              class="w-full px-4 py-2 font-semibold text-white transition-colors duration-200 bg-blue-600 rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-75"
            >
              New Game
            </button>
          </div>
        </div>
      `
    })

    app.use(MotionPlugin)
    app.mount('#app')
  </script>
</body>
</html>
